> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ https://mp.weixin.qq.com/s/YFMkJZXSqmc0OOuyAnc4mA

ç‚¹å‡»ä¸Šæ–¹ â€œ**åˆ˜æœ›èˆ’**â€ï¼Œé©¬ä¸Šå…³æ³¨ï¼Œæ—©ä¸Š **8:42** æ¨é€  

æŠ€æœ¯è¿›é˜¶å…³æ³¨ â€œ**åˆ˜æœ›èˆ’**â€ å°±å¯¹äº†

ä½œè€…Â :Â Â åˆ˜æœ›èˆ’Â Â |Â Â æ¥æºÂ ï¼šåˆ˜æœ›èˆ’çš„åšå®¢

åœ°å€ï¼šhttp://liuwangshu.cn/application/android-gradle/1-gradle-plug-in.html

### å‰è¨€

è€è¯»è€…éƒ½çŸ¥é“ï¼Œæˆ‘çš„æŠ€æœ¯åšå®¢ä» 2016 å¹´å¼€å§‹å°±æ²¡å†™è¿‡ä¸æˆç³»åˆ—çš„æ–‡ç« ï¼Œè¿™äº›ç³»åˆ—æ–‡ç« ç»„æˆäº†ç›®å‰ Android é¢†åŸŸæœ€å…¨é¢æ·±å…¥çš„åŸåˆ›çŸ¥è¯†ä½“ç³»ï¼Œæ›´ææ€–çš„æ˜¯è¿™ä¸ªä½“ç³»è¿˜åœ¨ä¸æ–­çš„æˆé•¿ï¼Œå…³äºè¿™ä¸ªçŸ¥è¯†ä½“ç³»å¯ä»¥ç‚¹å‡»Â é˜…è¯»åŸæ–‡Â äº†è§£ã€‚

ä»Šå¤©æˆ‘ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯ Android Gradle ç³»åˆ—æ–‡ç« çš„å¼€ç¯‡ï¼Œå®é™…ä¸Šåœ¨ Android Gradle ç³»åˆ—ä¹‹å‰ï¼Œæˆ‘å·²ç»å†™äº† Gradle æ ¸å¿ƒæ€æƒ³ç³»åˆ—ï¼Œè¿™ä¸ªç³»åˆ—æˆ‘å°½é‡é¿å…äº† Gradle å’Œ Android ä¹‹é—´çš„å…³è”ï¼Œè¿™æ˜¯å› ä¸ºåœ¨äº†è§£ Gradle çš„æ ¸å¿ƒæ€æƒ³åï¼Œå¯ä»¥æ›´å¥½çš„ç†è§£ Android Gradleï¼Œå› æ­¤è¿™é‡Œå¼ºçƒˆå»ºè®®å…ˆé˜…è¯» Gradle æ ¸å¿ƒæ€æƒ³ç³»åˆ—ã€‚

[ä¸ºä»€ä¹ˆç°åœ¨è¦ç”¨ Gradleï¼Ÿ](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649842700&idx=1&sn=3ea966869a96c36836aba920c774f0c3&chksm=83bf6d57b4c8e44110a7ce046a1a95d9847e2ccf3e7c0a1fac95b889ae2a55ace725e2630694&scene=21#wechat_redirect)

[Gradle å…¥é—¨å‰å¥](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649842877&idx=1&sn=618a4926808b1225b3fc6fc1803f7f99&chksm=83bf6de6b4c8e4f0c5d0956797a5698f70213c75d5ab175f2dcf36d4f42691378f4772832e30&scene=21#wechat_redirect)  

[Groovy å¿«é€Ÿå…¥é—¨çœ‹è¿™ç¯‡å°±å¤Ÿäº†](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649842919&idx=1&sn=212eac39bf76c4340b165a558572ce7f&chksm=83bf6dbcb4c8e4aaa82d57ad4667fbfa6c35102b0da5fd1d97f297fd33bbcd62be4e119c4eb7&scene=21#wechat_redirect)

[çœ‹ä¼¼æ— ç”¨ï¼Œå®åˆ™é‡è¦çš„ Gradle Wrapper](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649843617&idx=1&sn=de27f38a63a95368baa773cda463130d&chksm=83bf6efab4c8e7ec9aa85b397f5cc211940da51b68342962ce7f466bfa921a759bde32524166&scene=21#wechat_redirect)  

[é€šä¿—æ˜“æ‡‚çš„ Gradle æ’ä»¶è®²è§£](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649843752&idx=1&sn=b3b01ea8e56a3397de90b385a8b50c66&chksm=83bf6173b4c8e865f29a759328dc7160cee05cdc0198bc64db29814596d4e4c0c8762d62114e&scene=21#wechat_redirect)  

[é€šä¿—æ˜“æ‡‚çš„è‡ªå®šä¹‰ Gradle æ’ä»¶è®²è§£](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649843781&idx=1&sn=a7ee811d2bf739adf019c6cef405c8ef&chksm=83bf611eb4c8e808d817f8b4d96af97a13055a6c238a09bdd6206a44bb552388a7e15d37bec9&scene=21#wechat_redirect)

### 1. ä»€ä¹ˆæ˜¯ Gradle çš„ Android æ’ä»¶

åœ¨[é€šä¿—æ˜“æ‡‚çš„ Gradle æ’ä»¶è®²è§£](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649843752&idx=1&sn=b3b01ea8e56a3397de90b385a8b50c66&chksm=83bf6173b4c8e865f29a759328dc7160cee05cdc0198bc64db29814596d4e4c0c8762d62114e&scene=21#wechat_redirect)è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬çŸ¥é“ï¼ŒGradle æœ‰å¾ˆå¤šæ’ä»¶ï¼Œä¸ºäº†æ”¯æŒ Android é¡¹ç›®çš„æ„å»ºï¼Œè°·æ­Œä¸º Gradle ç¼–å†™äº† Android æ’ä»¶ï¼Œæ–°çš„ Android æ„å»ºç³»ç»Ÿå°±æ˜¯ç”± Gradle çš„ Android æ’ä»¶ç»„æˆçš„ï¼ŒGradle æ˜¯ä¸€ä¸ªé«˜çº§æ„å»ºå·¥å…·åŒ…ï¼Œå®ƒç®¡ç†ä¾èµ–é¡¹å¹¶å…è®¸å¼€å‘è€…è‡ªå®šä¹‰æ„å»ºé€»è¾‘ã€‚Android Studio ä½¿ç”¨ Gradle wrapper æ¥é›†æˆ Gradle çš„ Android æ’ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒGradle çš„ Android æ’ä»¶ä¹Ÿå¯ä»¥ç‹¬ç«‹äº AndroidStudio è¿è¡Œã€‚  
åœ¨ Android çš„å®˜æ–¹ç½‘ç«™æåˆ°äº†æ–°çš„ Android æ„å»ºç³»ç»Ÿä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š

*   ä»£ç å’Œèµ„æºæ˜“äºé‡ç”¨
    
*   æ— è®ºæ˜¯é’ˆå¯¹å¤šä¸ª apk å‘è¡Œç‰ˆè¿˜æ˜¯é’ˆå¯¹ä¸åŒé£æ ¼çš„åº”ç”¨ç¨‹åºï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“åˆ›å»ºåº”ç”¨ç¨‹åºçš„å¤šä¸ªä¸åŒç‰ˆæœ¬ã€‚
    
*   æ˜“äºé…ç½®ã€æ‰©å±•å’Œè‡ªå®šä¹‰æ„å»ºè¿‡ç¨‹
    
*   è‰¯å¥½çš„ IDE é›†æˆ
    

Gradle çš„ Android æ’ä»¶ç»“åˆ Android Studio æˆä¸ºäº†ç›®å‰æœ€ä¸ºæµè¡Œçš„ Android æ„å»ºç³»ç»Ÿã€‚

### 2. Android Studio çš„æ¨¡å—ç±»å‹å’Œé¡¹ç›®è§†å›¾

Android Studio ä¸­çš„æ¯ä¸ªé¡¹ç›®åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå«æœ‰æºä»£ç æ–‡ä»¶å’Œèµ„æºæ–‡ä»¶çš„æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯ä»¥ç‹¬ç«‹æ„å»ºã€æµ‹è¯•æˆ–è°ƒè¯•ï¼Œä¸€ä¸ª Android Studio çš„æ¨¡å—ç±»å‹å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§ï¼š

**Android åº”ç”¨ç¨‹åºæ¨¡å—**  
Â Android åº”ç”¨ç¨‹åºæ¨¡å—å¯èƒ½ä¾èµ–äºåº“æ¨¡å—ï¼Œå°½ç®¡è®¸å¤š Android åº”ç”¨ç¨‹åºåªåŒ…å«ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¨¡å—ï¼Œæ„å»ºç³»ç»Ÿä¼šå°†å…¶ç”Ÿæˆä¸€ä¸ª APKã€‚

**Android åº“æ¨¡å—**  
Android åº“æ¨¡å—åŒ…å«å¯é‡ç”¨çš„ç‰¹å®šäº Android çš„ä»£ç å’Œèµ„æºï¼Œæ„å»ºç³»ç»Ÿä¼šå°†å…¶ç”Ÿæˆä¸€ä¸ª AARã€‚

**App å¼•æ“æ¨¡å—**  
åŒ…å«åº”ç”¨ç¨‹åºå¼•æ“é›†æˆçš„ä»£ç å’Œèµ„æºã€‚

**Java åº“æ¨¡å—**  
åŒ…å«å¯é‡ç”¨çš„ä»£ç ï¼Œæ„å»ºç³»ç»Ÿä¼šå°†å…¶ç”Ÿæˆä¸€ä¸ª JAR åŒ…ã€‚

Android Studio3.3.2 ä¸­çš„ Android é¡¹ç›®è§†å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚  

![](https://mmbiz.qpic.cn/mmbiz_png/nk8ic4xzfuQ92fGz4RmicItCic0Loeo1XYlTyg9kUMGByNt7LbicNVfbxKUDB4pNRFRyNgTZw5Z0eUNxhRAicquT8jw/640?wx_fmt=png)1.png  
æ‰€æœ‰æ„å»ºæ–‡ä»¶åœ¨ Gradle Scripts å±‚çº§ä¸‹æ˜¾ç¤ºï¼Œå¤§æ¦‚ä»‹ç»ä¸‹è¿™äº›æ–‡ä»¶çš„ç”¨å¤„ã€‚

  

*   é¡¹ç›® build.gradleï¼šé…ç½®é¡¹ç›®çš„æ•´ä½“å±æ€§ï¼Œæ¯”å¦‚æŒ‡å®šä½¿ç”¨çš„ä»£ç ä»“åº“ã€ä¾èµ–çš„ Gradle æ’ä»¶ç‰ˆæœ¬ç­‰ç­‰ã€‚
    
*   æ¨¡å— build.gradleï¼šé…ç½®å½“å‰ Module çš„ç¼–è¯‘å‚æ•°ã€‚
    
*   gradle-wrapper.properitesï¼šé…ç½® Gradle Wrapperï¼Œå¯ä»¥æŸ¥çœ‹ Gradle æ ¸å¿ƒæ€æƒ³ï¼ˆå››ï¼‰çœ‹ä¼¼æ— ç”¨ï¼Œå®åˆ™é‡è¦çš„ Gradle Wrapper è¿™ç¯‡æ–‡ç« ã€‚
    
*   gradle.propertiesï¼šé…ç½® Gradle çš„ç¼–è¯‘å‚æ•°ã€‚å…·ä½“é…ç½®è§ Gradle å®˜æ–¹æ–‡æ¡£
    
*   settings.gradleï¼šé…ç½® Gradle çš„å¤šé¡¹ç›®ç®¡ç†ã€‚
    
*   local.propertiesï¼šä¸€èˆ¬ç”¨æ¥å­˜æ”¾è¯¥ Android é¡¹ç›®çš„ç§æœ‰å±æ€§é…ç½®ï¼Œæ¯”å¦‚ Android é¡¹ç›®çš„ SDK è·¯å¾„ã€‚
    

è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»é¡¹ç›® build.gradle å’Œæ¨¡å— build.gradleã€‚

### 3. é¡¹ç›® build.gradle

æˆ‘ä»¬æ–°å»ºä¸€ä¸ª Android é¡¹ç›®ï¼Œå®ƒçš„é¡¹ç›® build.gradle çš„å†…å®¹å¦‚ä¸‹ï¼š

```
buildscriptÂ {
Â Â Â Â repositoriesÂ {
Â Â Â Â Â Â Â Â google()
Â Â Â Â Â Â Â Â jcenter()Â Â Â 
Â Â Â Â }
Â Â Â Â dependenciesÂ {
Â Â Â Â Â Â Â Â classpathÂ 'com.android.tools.build:gradle:3.3.2'Â //1
Â Â Â Â }
}

allprojectsÂ {
Â Â Â Â repositoriesÂ {
Â Â Â Â Â Â Â Â google()
Â Â Â Â Â Â Â Â jcenter()Â Â 
Â Â Â Â }
}

taskÂ clean(type:Â Delete)Â {
Â Â Â Â deleteÂ rootProject.buildDir
}


```

æ³¨é‡Š 1 å¤„é…ç½®ä¾èµ–çš„ Gradle æ’ä»¶ç‰ˆæœ¬ï¼ŒGradle æ’ä»¶å±äºç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå› æ­¤è¿™é‡Œåœ¨ buildscrip å—ä¸­é…ç½®è°·æ­Œçš„ Maven åº“å’Œ JCenter åº“ï¼Œè¿™æ · Gradle ç³»ç»Ÿæ‰èƒ½æ‰¾åˆ°å¯¹åº”çš„ Gradle æ’ä»¶ã€‚  
å¦‚æœä½¿ç”¨`google()`æŠ¥`notÂ found:Â 'google()'`é”™è¯¯ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹ä»£ç æ›¿ä»£ï¼š

```
mavenÂ {Â urlÂ 'https://maven.google.com'Â }


```

å¦‚æœä½ è¿˜ä¸ç†è§£ Gradle æ’ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹ Gradle æ ¸å¿ƒæ€æƒ³ï¼ˆäº”ï¼‰é€šä¿—æ˜“æ‡‚çš„ Gradle æ’ä»¶è®²è§£è¿™ç¯‡æ–‡ç« ã€‚

### 4. æ¨¡å— build.gradle

æ–°å»ºä¸€ä¸ª Android é¡¹ç›®ï¼Œå®ƒçš„æ¨¡å— build.gradle çš„å†…å®¹å¦‚ä¸‹ï¼š

```
applyÂ plugin:Â 'com.android.application'

androidÂ {
Â Â Â Â compileSdkVersionÂ 28
Â Â Â Â defaultConfigÂ {
Â Â Â Â Â Â Â Â applicationIdÂ "com.example.myapplication"
Â Â Â Â Â Â Â Â minSdkVersionÂ 15
Â Â Â Â Â Â Â Â targetSdkVersionÂ 28
Â Â Â Â Â Â Â Â versionCodeÂ 1
Â Â Â Â Â Â Â Â versionNameÂ "1.0"
Â Â Â Â Â Â Â Â testInstrumentationRunnerÂ "android.support.test.runner.AndroidJUnitRunner"
Â Â Â Â }
Â Â Â Â buildTypesÂ {
Â Â Â Â Â Â Â Â releaseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â minifyEnabledÂ false
Â Â Â Â Â Â Â Â Â Â Â Â proguardFilesÂ getDefaultProguardFile('proguard-android-optimize.txt'),Â 'proguard-rules.pro'
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}

dependenciesÂ {
Â Â Â Â implementationÂ fileTree(dir:Â 'libs',Â include:Â ['*.jar'])
Â Â Â Â implementationÂ 'com.android.support:appcompat-v7:28.0.0'
Â Â Â Â implementationÂ 'com.android.support.constraint:constraint-layout:1.1.3'
Â Â Â Â testImplementationÂ 'junit:junit:4.12'
Â Â Â Â androidTestImplementationÂ 'com.android.support.test:runner:1.0.2'
Â Â Â Â androidTestImplementationÂ 'com.android.support.test.espresso:espresso-core:3.0.2'
}


```

#### 4.1 Gradle çš„ Android æ’ä»¶ç±»å‹

apply å¼•å…¥çš„æ’ä»¶ id ä¸º com.android.applicationï¼Œè¯´æ˜å½“å‰æ¨¡å—æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¨¡å—ï¼ŒGradle çš„ Android æ’ä»¶æœ‰å¤šä¸ªç±»å‹åˆ†åˆ«ä¸ºï¼š

*   åº”ç”¨ç¨‹åºæ’ä»¶ï¼Œæ’ä»¶ id ä¸º com.android.applicationï¼Œä¼šç”Ÿæˆä¸€ä¸ª APKã€‚
    
*   åº“æ’ä»¶ï¼Œæ’ä»¶ id ä¸º com.android.libraryï¼Œä¼šç”Ÿæˆä¸€ä¸ª AARï¼Œæä¾›ç»™å…¶ä»–åº”ç”¨ç¨‹åºæ¨¡å—ç”¨ã€‚
    
*   æµ‹è¯•æ’ä»¶ï¼Œæ’ä»¶ id ä¸º com.android.testï¼Œç”¨äºæµ‹è¯•å…¶ä»–çš„æ¨¡å—ã€‚
    
*   feature æ’ä»¶ï¼Œæ’ä»¶ id ä¸º com.android.featureï¼Œåˆ›å»º Android Instant App æ—¶éœ€è¦ç”¨åˆ°çš„æ’ä»¶ã€‚
    
*   Instant App æ’ä»¶ï¼Œæ’ä»¶ id ä¸º com.android.instantappï¼Œæ˜¯ Android Instant App çš„å…¥å£ã€‚
    

#### 4.2 Android å—

Android å—ç”¨äºæè¿°è¯¥ Module æ„å»ºè¿‡ç¨‹ä¸­æ‰€ç”¨åˆ°çš„æ‰€æœ‰å‚æ•°ã€‚

*   compileSdkVersionï¼šé…ç½®ç¼–è¯‘è¯¥æ¨¡å—çš„ SDK ç‰ˆæœ¬
    
*   buildToolsVersionï¼šAndroid æ„å»ºå·¥å…·çš„ç‰ˆæœ¬
    

##### 4.2.1 defaultConfig å—

Android å—ä¸­çš„ defaultConfig å—ç”¨äºé»˜è®¤é…ç½®ï¼Œå¸¸ç”¨çš„é…ç½®å¦‚ä¸‹æ‰€ç¤ºã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/nk8ic4xzfuQ92fGz4RmicItCic0Loeo1XYllFvegCK72YclCyqbHL0eFTpdiaWXLZPPl2WiaiaSCOaZYqRlhuWQ8Nc1Q/640?wx_fmt=png)

#####   
buildTypes å—ç”¨äºé…ç½®æ„å»ºä¸åŒç±»å‹çš„ APKã€‚4.2.2 buildTypes å—

å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œåœ¨ Android å—å·²ç»é»˜è®¤é…ç½®äº† buildTypes å—ï¼š

```
Â buildTypesÂ {
Â Â Â Â Â Â Â Â releaseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â minifyEnabledÂ false
Â Â Â Â Â Â Â Â Â Â Â Â proguardFilesÂ getDefaultProguardFile('proguard-android-optimize.txt'),Â 'proguard-rules.pro'
Â Â Â Â Â Â Â Â }
Â Â Â Â }


```

åœ¨ AS çš„ Terminal ä¸­æ‰§è¡Œ gradlew.bat build å‘½ä»¤ï¼Œä¼šåœ¨è¯¥æ¨¡å—çš„ build/outputs/apk ç›®å½•ä¸­ç”Ÿæˆ release å’Œ debug çš„ APKï¼Œè™½ç„¶åªé…ç½®äº† release ï¼Œä½† release å’Œ debug æ˜¯é»˜è®¤é…ç½®ï¼Œå³ä½¿æˆ‘ä»¬ä¸é…ç½®ä¹Ÿä¼šç”Ÿæˆã€‚ä¹Ÿå¯ä»¥ä¿®æ”¹é»˜è®¤çš„ release å’Œ debugï¼Œç”šè‡³å¯ä»¥è‡ªå®šä¹‰æ„å»ºç±»å‹ï¼Œæ¯”å¦‚ï¼š

```
Â buildTypesÂ {
Â Â Â Â Â Â Â Â releaseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â minifyEnabledÂ false
Â Â Â Â Â Â Â Â Â Â Â Â proguardFilesÂ getDefaultProguardFile('proguard-android-optimize.txt'),Â 'proguard-rules.pro'
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â debugÂ {
Â Â Â Â Â Â Â Â Â Â Â Â debuggableÂ true
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â privitedebug{
Â Â Â Â Â Â Â Â Â Â Â Â applicationIdSuffixÂ ""
Â Â Â Â Â Â Â Â }
Â Â Â Â }


```

è¿™æ—¶ä¼šåœ¨ build/outputs/apk ç›®å½•ä¸­ç”Ÿæˆ releaseã€debugã€privitedebug çš„ APKã€‚  
buildTypes å—è¿˜å¯ä»¥é…ç½®å¾ˆå¤šå±æ€§ï¼Œå¸¸ç”¨çš„é…ç½®å¦‚ä¸‹æ‰€ç¤ºã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/nk8ic4xzfuQ92fGz4RmicItCic0Loeo1XYlibMqAfWzHBbOKHcoO0bicbjWtSEaiao1w70R1xeBgDLEicjfGcyxtvz2DA/640?wx_fmt=png)

##### 4.2.3 signingConfigs å—

ç”¨äºé…ç½®ç­¾åè®¾ç½®ï¼Œä¸€èˆ¬ç”¨æ¥é…ç½® release æ¨¡å¼ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/nk8ic4xzfuQ92fGz4RmicItCic0Loeo1XYl6v9WjtT7ibSKficJNVPbSJPKmf42D6EtGyp8U606cjlaBM01hevrib7WA/640?wx_fmt=png)

```
signingConfigsÂ {
Â Â Â Â Â Â Â Â releaseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â storeFileÂ file('C:/Users/liuwangshu/.android/release.keystore')
Â Â Â Â Â Â Â Â Â Â Â Â storePasswordÂ 'android'
Â Â Â Â Â Â Â Â Â Â Â Â keyAliasÂ 'androidreleasekey'
Â Â Â Â Â Â Â Â Â Â Â Â keyPasswordÂ 'android'

Â Â Â Â Â Â Â Â }


```

##### 4.2.4 å…¶ä»–é…ç½®å—

android å—ä¸­é™¤äº†å‰é¢è®²çš„ defaultConfig å—ã€buildTypes å—ã€signingConfigs å—è¿˜æœ‰å…¶ä»–çš„é…ç½®å—ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/nk8ic4xzfuQ92fGz4RmicItCic0Loeo1XYllXuxeeOV92XuOJOtELibXhcKOCrkic5vLHN1Dod4HLTNP0znSTjNqGTQ/640?wx_fmt=png)

æ›´å¤šçš„é…ç½®å—è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚

##### 4.2.4 å…¨å±€é…ç½®

å¦‚æœæœ‰å¤šä¸ª module çš„é…ç½®æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥å°†è¿™äº›é…ç½®æå–å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å…¨å±€é…ç½®ã€‚å…¨å±€é…ç½®æœ‰å¤šç§æ–¹å¼ï¼Œè¿™é‡Œä»‹ç»å…¶ä¸­çš„ä¸¤ç§ã€‚  
**1. ä½¿ç”¨ ext å—é…ç½®**  
Â åœ¨é¡¹ç›® build.gradle ä¸­ä½¿ç”¨ ext å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```
ext{
Â Â Â Â compileSdkVersionÂ =28
Â Â Â Â buildToolsVersionÂ ="28.0.3"
Â Â Â Â minSdkVersionÂ =15
Â Â Â Â targetSdkVersionÂ =28
}


```

åœ¨æŸä¸ª module çš„ build.gradle ä¸­ä½¿ç”¨é…ç½®ï¼š

```
applyÂ plugin:Â 'com.android.application'
androidÂ {
Â Â Â Â compileSdkVersionÂ rootProject.ext.compileSdkVersion
Â Â Â Â buildToolsVersionÂ rootProject.ext.buildToolsVersion
Â Â Â Â defaultConfigÂ {
Â Â Â Â Â Â Â Â applicationIdÂ "com.example.liuwangshu.hookinstrumentation"
Â Â Â Â Â Â Â Â minSdkVersionÂ rootProject.ext.minSdkVersion
Â Â Â Â Â Â Â Â targetSdkVersionÂ rootProject.ext.targetSdkVersion
Â Â Â Â Â Â Â Â versionCodeÂ 1
Â Â Â Â Â Â Â Â versionNameÂ "1.0"
Â Â Â Â Â Â Â Â testInstrumentationRunnerÂ "android.support.test.runner.AndroidJUnitRunner"
Â Â Â Â }
Â Â ...
}
...


```

**2. ä½¿ç”¨ config.gradle é…ç½®**  
é¦–å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º config.gradle æ–‡ä»¶æ¥è¿›è¡Œé…ç½®ã€‚  
**config.gradle**

```
ext{
Â Â Â Â android=[
Â Â Â Â Â Â Â Â Â Â Â Â applicationId:"com.example.liuwangshu.hookinstrumentation",
Â Â Â Â Â Â Â Â Â Â Â Â compileSdkVersionÂ :28,
Â Â Â Â Â Â Â Â Â Â Â Â buildToolsVersionÂ :"28.0.3",
Â Â Â Â Â Â Â Â Â Â Â Â minSdkVersionÂ :Â 15,
Â Â Â Â Â Â Â Â Â Â Â Â targetSdkVersionÂ :Â 28,
Â Â Â Â ]

Â Â Â Â dependenciesÂ =[
Â Â Â Â Â Â Â Â Â Â Â Â "appcompat-v7"Â :Â "com.android.support:appcompat-v7:28.0.0",
Â Â Â Â Â Â Â Â Â Â Â Â "constraint"Â Â :Â "com.android.support.constraint:constraint-layout:1.1.3",
Â Â Â Â ]
}


```

æ¥ç€åœ¨é¡¹ç›® build.gradle ä¸­æ·»åŠ `applyÂ from:Â "config.gradle"`ï¼Œè¿™æ ·é¡¹ç›®çš„æ‰€æœ‰ module éƒ½èƒ½ç”¨ config.gradle ä¸­å®šä¹‰çš„å‚æ•°ã€‚  
æœ€ååœ¨ module çš„ build.gradle ä¸­ä½¿ç”¨é…ç½®ï¼š

```
applyÂ plugin:Â 'com.android.application'
androidÂ {
Â Â Â Â compileSdkVersionÂ rootProject.ext.android.compileSdkVersion
Â Â Â Â buildToolsVersionÂ rootProject.ext.android.buildToolsVersion
Â Â Â Â defaultConfigÂ {
Â Â Â Â Â Â Â Â applicationIdÂ rootProject.ext.android.applicationId
Â Â Â Â Â Â Â Â minSdkVersionÂ rootProject.ext.android.minSdkVersion
Â Â Â Â Â Â Â Â targetSdkVersionÂ rootProject.ext.android.targetSdkVersion
Â Â Â Â Â Â Â Â versionCodeÂ 1
Â Â Â Â Â Â Â Â versionNameÂ "1.0"
Â Â Â Â Â Â Â Â testInstrumentationRunnerÂ "android.support.test.runner.AndroidJUnitRunner"
Â Â Â Â }
Â Â Â ...
dependenciesÂ {
Â Â Â Â implementationÂ rootProject.ext.dependencies["constraint"]
Â Â Â Â implementationÂ rootProject.ext.dependencies["appcompat-v7"]
Â Â Â Â ...
}


```

#### 4.2 dependencies å—

dependencies å—ç”¨äºé…ç½®è¯¥ module æ„å»ºè¿‡ç¨‹ä¸­æ‰€ä¾èµ–çš„æ‰€æœ‰åº“ã€‚Gradle æ’ä»¶ 3.4 ç‰ˆæœ¬æ–°å¢äº† api å’Œ implementation æ¥ä»£æ›¿ compile é…ç½®ä¾èµ–ï¼Œå…¶ä¸­ api å’Œæ­¤å‰çš„ compile æ˜¯ä¸€æ ·çš„ã€‚dependencies å’Œ api ä¸»è¦ä»¥ä¸‹çš„åŒºåˆ«ï¼š

*   implementation å¯ä»¥è®© module åœ¨ç¼–è¯‘æ—¶éšè—è‡ªå·±ä½¿ç”¨çš„ä¾èµ–ï¼Œä½†æ˜¯åœ¨è¿è¡Œæ—¶è¿™ä¸ªä¾èµ–å¯¹æ‰€æœ‰æ¨¡å—æ˜¯å¯è§çš„ã€‚è€Œ api ä¸ compile ä¸€æ ·ï¼Œæ— æ³•éšè—è‡ªå·±ä½¿ç”¨çš„ä¾èµ–ã€‚
    
*   å¦‚æœä½¿ç”¨ apiï¼Œä¸€ä¸ª module å‘ç”Ÿå˜åŒ–ï¼Œè¿™æ¡ä¾èµ–é“¾ä¸Šæ‰€æœ‰çš„ module éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œè€Œä½¿ç”¨ implementionï¼Œåªæœ‰ç›´æ¥ä¾èµ–è¿™ä¸ª module éœ€è¦é‡æ–°ç¼–è¯‘ã€‚
    

æ„Ÿè°¢  
https://jeroenmols.com/blog/2017/06/14/androidstudio3/  
http://google.github.io/android-gradle-dsl/current/  
http://www.androiddocs.com/tools/building/plugin-for-gradle.html  
https://www.jianshu.com/p/8962d6ba936e  
https://www.jianshu.com/p/b6744e1e4f7c  
ã€ŠAndroid ç¾¤è‹±ä¼  ç¥å…µåˆ©å™¨ã€‹

--------Â  ENDÂ  ---------

**æ¨èé˜…è¯»**

[ä»Šå¤©ï¼Œæˆ‘éœ€è¦ä½ çš„æ”¯æŒï¼](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649844554&idx=1&sn=ccd7d38662f732a22cf9309533238187&chksm=83bf6211b4c8eb0762d88c518e487ebb44bf71f37ac9ae72761ac33350628e866c5cf73f4402&scene=21#wechat_redirect)

[Android ç³»ç»ŸæœåŠ¡ï¼ˆä¸€ï¼‰è§£æ ActivityManagerService(AMS)](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649841686&idx=1&sn=38565aab03c212dde0e8647d13197bad&chksm=83bf694db4c8e05b97dc5ca9e5eea58679c764aac8405c44f46eb4581742500101399d845290&scene=21#wechat_redirect)  

[ä¸ºä»€ä¹ˆé˜¿é‡Œä¸å»ºè®®åœ¨ for å¾ªç¯ä¸­ä½¿ç”¨ "+" è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥](http://mp.weixin.qq.com/s?__biz=MzAxMTg2MjA2OA==&mid=2649843636&idx=1&sn=ff63fd15c4830e58a9f3f63dbed7a948&chksm=83bf6eefb4c8e7f9f5ac7a8518447fd06de1669f0399bf57d4d45b2263bf6e0a17381c3433aa&scene=21#wechat_redirect)  

**ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜æœ›èˆ’ï¼Œ****åå¹´ç»éªŒçš„èµ„æ·±æ¶æ„å¸ˆï¼Œè‘—æœ‰ä¸¤æœ¬ä¸šç•ŒçŸ¥åçš„æŠ€æœ¯ç•…é”€ä¹¦ï¼Œå¤šä¸ªçŸ¥åæŠ€æœ¯å¤§ä¼šçš„ç‰¹é‚€æ¼”è®²å˜‰å®¾ã€‚**

å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œå°±ç»™å…¬ä¼—å·åŠ ä¸ªæ˜Ÿæ ‡å§ï¼Œæ–¹ä¾¿é˜…è¯»ã€‚

![](https://mmbiz.qpic.cn/mmbiz_jpg/nk8ic4xzfuQ9RM3USPLDqBo9wJqSXic3hf6pFF6y7wYtpLFpNgMLsLPF04flU5kPxG4IGLorFiaoXnvautHxSFzEw/640?wx_fmt=jpeg)

å¬è¯´æœ‰äººä¸æ•¢ç‚¹è¿™é‡Œ ğŸ‘‡